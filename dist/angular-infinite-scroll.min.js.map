{"version":3,"sources":["webpack:///webpack/bootstrap 6f83233afabb9ce72a1d","webpack:///./src/module.ts","webpack:///./src/descriptor.ts","webpack:///./src/scroller-factory.ts","webpack:///./src/scroll-detector.ts","webpack:///./src/elements-manager.ts","webpack:///./src/scroller.ts","webpack:///./src/revealer-elements-manager.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","descriptor_1","scroller_factory_1","angular","directive","transclude","link","scope","element","attr","ctrl","linker","descriptor","Descriptor","createFrom","ScrollerFactory","match","infiniteScroller","indexString","collectionString","CollectionString","IndexString","UseRevealer","undefined","Element","Scope","scroll_detector_1","elements_manager_1","scroller_1","revealer_elements_manager_1","detector","ScrollDetector","elementsManager","RevealerElementsManager","Scroller","ElementsManager","_this","this","lastScrollTop","BUFFER_COUNT","SubscribeTo","parent","parentEl","bind","scrollTop","offsetHeight","scrollHeight","OnScrollDown","topElement","children","OnScrollUp","LOAD_COUNT","UpdateCollection","newCollection","collection","AddBottom","updateScopes","AddTop","countTillStop","displayFrom","newElement","transcludeElement","container","prepend","items","unshift","overflowCounter","length","displayTo","item","append","push","blockEl","parentBottom","containerElement","offsetTop","RemoveTop","hasInvisibleChildren","el","removeElement","RemoveBottom","index","childScope","$new","clone","splice","remove","$destroy","$on","scrollDetector","onCollectionUpdated","onScrollDown","$apply","onScrollUp","$watchCollection","REVEALER_SIZE_TO_CONTAINER","InitializeRevealer","_i","_a","revealers","revealer","revealerSize","hasItemToBind","hasElementToBind","Items","pop","currentDisplayTo","filter","r","newRevealer","createRevealer","isRevealerFilled","fillUntil","item_1","shift","scrollTo"],"mappings":"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","file":"angular-infinite-scroll.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6f83233afabb9ce72a1d","import { Descriptor } from './descriptor';\r\nimport { ScrollerFactory } from \"./scroller-factory\";\r\n\r\ndeclare var angular;\r\n\r\nconst scrollerModule = angular.module('angular-infinite-scroller', []);\r\n\r\nscrollerModule.directive('infiniteScroller', () => {\r\n    return {\r\n        transclude: 'element',\r\n        link: (scope: ng.IScope, element: JQLite, attr: ng.IAttributes, ctrl, linker: ng.ITranscludeFunction) => {\r\n            const descriptor = Descriptor.createFrom(scope, element, attr);\r\n            const scroller = ScrollerFactory.createFrom(descriptor, linker);\r\n        }\r\n    }\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/module.ts","export class Descriptor {\r\n    private constructor() { }\r\n\r\n    public CollectionString: string\r\n    public IndexString: string;\r\n    public UseRevealer: boolean;\r\n    public Scope: ng.IScope;\r\n    public Element: JQLite;\r\n\r\n    static createFrom(scope: ng.IScope, element: JQLite, attr: ng.IAttributes): Descriptor {\r\n        const loop = attr.infiniteScroller,\r\n            match = loop.match(/^\\s*(.+)\\s+in\\s+(.*?)$/),\r\n            indexString = match[1],\r\n            collectionString = match[2];\r\n\r\n        const descriptor = new Descriptor();\r\n        descriptor.CollectionString = collectionString;\r\n        descriptor.IndexString = indexString;\r\n        descriptor.UseRevealer = attr['useRevealer'] != undefined;\r\n        descriptor.Element = element;\r\n        descriptor.Scope = scope;\r\n\r\n        return descriptor;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/descriptor.ts","import { Descriptor } from \"./descriptor\";\r\nimport { ScrollDetector } from \"./scroll-detector\";\r\nimport { ElementsManager } from \"./elements-manager\";\r\nimport { Scroller, IScroller } from \"./scroller\";\r\nimport { RevealerElementsManager } from \"./revealer-elements-manager\";\r\n\r\nexport class ScrollerFactory {\r\n    static createFrom(descriptor: Descriptor, linker: ng.ITranscludeFunction): IScroller {\r\n        const detector = new ScrollDetector();\r\n\r\n        if (descriptor.UseRevealer) {\r\n            const elementsManager = new RevealerElementsManager(descriptor, linker);\r\n            return new Scroller(descriptor, detector, elementsManager);\r\n        } else {\r\n            const elementsManager = new ElementsManager(descriptor, linker);\r\n            return new Scroller(descriptor, detector, elementsManager);\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scroller-factory.ts","export class ScrollDetector {\r\n    private lastScrollTop = 0;\r\n    private BUFFER_COUNT = 5;\r\n\r\n    constructor() {\r\n\r\n    }\r\n\r\n    public SubscribeTo = (element: JQLite) => {\r\n        const parent: JQLite = element.parent();\r\n        const parentEl: HTMLElement = parent[0];\r\n\r\n        parent.bind('scroll', () => {\r\n            if (this.lastScrollTop < parentEl.scrollTop) {\r\n                const current = parentEl.scrollTop + parentEl.offsetHeight;\r\n                const bottom = parentEl.scrollHeight;\r\n\r\n                if (current == bottom) {\r\n                    this.OnScrollDown && this.OnScrollDown();\r\n                }\r\n            } else if (this.lastScrollTop > parentEl.scrollTop) {\r\n                const topElement = parentEl.children[0];\r\n                if (topElement && parentEl.scrollTop <= (topElement.scrollHeight * this.BUFFER_COUNT)) {\r\n                    this.OnScrollUp && this.OnScrollUp();\r\n                }\r\n            }\r\n            this.lastScrollTop = parent[0].scrollTop;\r\n        });\r\n    }\r\n\r\n    public OnScrollDown?: () => void;\r\n    public OnScrollUp?: () => void;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scroll-detector.ts","import { Descriptor } from \"./descriptor\";\r\n\r\nexport type Item = {\r\n    Element: JQLite,\r\n    Scope: ng.IScope\r\n}\r\n\r\nexport interface IElementsManager {\r\n    UpdateCollection(newCollection: any[]): void;\r\n    AddTop(): void;\r\n    AddBottom(): void;\r\n    RemoveTop(): void;\r\n    RemoveBottom(): void;\r\n}\r\n\r\nexport class ElementsManager implements IElementsManager {\r\n    private collection: any[];\r\n    private container: JQLite;\r\n    private containerElement: HTMLElement;\r\n    private items: Item[];\r\n    private displayFrom: number;\r\n    private displayTo: number;\r\n\r\n    private BUFFER_COUNT = 5;\r\n    private LOAD_COUNT = 10;\r\n\r\n    constructor(private descriptor: Descriptor, private linker: ng.ITranscludeFunction) {\r\n        this.items = [];\r\n        this.displayFrom = 0;\r\n        this.displayTo = 0;\r\n        this.container = descriptor.Element.parent();\r\n        this.containerElement = this.container[0];\r\n\r\n        // this way the memory can only leak until the scroller lives\r\n        this.descriptor.Scope.$on('$destroy', () => {\r\n            this.items = [];\r\n        });\r\n    }\r\n\r\n    public UpdateCollection = (newCollection: any[]) => {\r\n        if (this.collection == undefined) {\r\n            this.collection = newCollection;\r\n            this.AddBottom();\r\n        } else {\r\n            this.collection = newCollection;\r\n            this.updateScopes();\r\n        }\r\n    }\r\n\r\n    public AddTop = () => {\r\n        let countTillStop = this.LOAD_COUNT;\r\n\r\n        for (var i = this.displayFrom - 1; i >= 0 && countTillStop > 0; i--) {\r\n            const newElement = this.transcludeElement(i);\r\n            this.container.prepend(newElement.Element);\r\n            this.items.unshift(newElement);\r\n\r\n            countTillStop--;\r\n        }\r\n\r\n        this.displayFrom = i + 1;\r\n    };\r\n\r\n    public AddBottom = () => {\r\n        // add this many children below visible area\r\n        let overflowCounter = this.items.length > 0 ? this.BUFFER_COUNT : this.LOAD_COUNT;\r\n\r\n        for (var i = this.displayTo; i < this.collection.length && overflowCounter > 0; i++) {\r\n            const item = this.transcludeElement(i);\r\n            this.container.append(item.Element);\r\n            this.items.push(item);\r\n\r\n            const blockEl = item.Element[0];\r\n            const parentBottom = this.containerElement.offsetTop + this.containerElement.scrollTop + this.containerElement.offsetHeight;\r\n            const blockBottom = blockEl.offsetTop + blockEl.offsetHeight;\r\n\r\n            if (blockBottom > parentBottom) {\r\n                overflowCounter--;\r\n            }\r\n        }\r\n\r\n        this.displayTo = i;\r\n    };\r\n\r\n    public RemoveTop = () => {\r\n        if (this.items.length < this.BUFFER_COUNT) {\r\n            return;\r\n        }\r\n\r\n        let hasInvisibleChildren = true;\r\n        while (hasInvisibleChildren) {\r\n            const el = this.items[this.BUFFER_COUNT].Element[0];\r\n            const elementBottom = el.offsetTop + el.offsetHeight;\r\n            const scrollTop = this.containerElement.offsetTop + this.containerElement.scrollTop;\r\n\r\n            if (elementBottom < scrollTop) {\r\n                this.removeElement(0);\r\n                this.displayFrom++;\r\n            } else {\r\n                hasInvisibleChildren = false;\r\n            }\r\n        }\r\n    };\r\n\r\n    public RemoveBottom = () => {\r\n        if (this.items.length < this.BUFFER_COUNT) {\r\n            return;\r\n        }\r\n\r\n        let hasInvisibleChildren = true;\r\n        while (hasInvisibleChildren) {\r\n            const el = this.items[this.items.length - this.BUFFER_COUNT].Element[0];\r\n            const elementTop = el.offsetTop;\r\n            const bottom = this.containerElement.offsetHeight + this.containerElement.scrollTop + this.containerElement.offsetHeight;\r\n\r\n            if (elementTop > bottom) {\r\n                this.removeElement(this.items.length - 1);\r\n                this.displayTo--;\r\n            } else {\r\n                hasInvisibleChildren = false;\r\n            }\r\n        }\r\n    };\r\n\r\n    private updateScopes = () => {\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            const item = this.items[i];\r\n            item.Scope[this.descriptor.IndexString] = this.collection[this.displayFrom + i];\r\n        }\r\n\r\n        // TODO: clean dom if removal took place \r\n    };\r\n\r\n    private transcludeElement = (index: number): Item => {\r\n        const item = {} as Item;\r\n\r\n        const childScope = this.descriptor.Scope.$new();\r\n        childScope[this.descriptor.IndexString] = this.collection[index];\r\n\r\n        this.linker(childScope, (clone: JQLite) => {\r\n            item.Element = clone;\r\n            item.Scope = childScope;\r\n        });\r\n\r\n        return item;\r\n    }\r\n\r\n    private removeElement = (index: number) => {\r\n        const item = this.items.splice(index, 1)[0];\r\n        item.Element.remove();\r\n        item.Scope.$destroy();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/elements-manager.ts","import { Descriptor } from \"./descriptor\";\r\nimport { ScrollDetector } from \"./scroll-detector\";\r\nimport { IElementsManager } from \"./elements-manager\";\r\n\r\nexport interface IScroller {\r\n\r\n}\r\n\r\nexport class Scroller implements IScroller {\r\n    private get scope(): ng.IScope {\r\n        return this.descriptor.Scope;\r\n    }\r\n\r\n    public constructor(private descriptor: Descriptor, private scrollDetector: ScrollDetector, private elementsManager: IElementsManager) {\r\n        this.scrollDetector.OnScrollDown = this.onScrollDown;\r\n        this.scrollDetector.OnScrollUp = this.onScrollUp;\r\n\r\n        this.scrollDetector.SubscribeTo(descriptor.Element);\r\n        \r\n        this.scope.$watchCollection(descriptor.CollectionString, this.onCollectionUpdated);\r\n    }\r\n\r\n    private onCollectionUpdated = (newCollection: any[]): void => {\r\n        this.elementsManager.UpdateCollection(newCollection);\r\n    };\r\n\r\n    private onScrollDown = (): void => {\r\n        this.scope.$apply(() => {\r\n            this.elementsManager.AddBottom();\r\n            this.elementsManager.RemoveTop();\r\n        });\r\n    };\r\n\r\n    private onScrollUp = (): void => {\r\n        this.scope.$apply(() => {\r\n            this.elementsManager.AddTop();\r\n            this.elementsManager.RemoveBottom();\r\n        });\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/scroller.ts","import { Item, IElementsManager } from \"./elements-manager\";\r\nimport { Descriptor } from \"./descriptor\";\r\n\r\ndeclare var angular;\r\n\r\ntype Revealer = {\r\n    Element: JQLite;\r\n    Items: Item[];\r\n}\r\n\r\nexport class RevealerElementsManager implements IElementsManager {\r\n    private collection: any[];\r\n    private container: JQLite;\r\n    private containerElement: HTMLElement;\r\n    private displayFrom: number;\r\n    private displayTo: number;\r\n\r\n    private revealers: Revealer[];\r\n    private revealerSize: number;\r\n\r\n    private BUFFER_COUNT = 5;\r\n    private LOAD_COUNT = 10;\r\n    private REVEALER_SIZE_TO_CONTAINER = 0.75\r\n\r\n    constructor(private descriptor: Descriptor, private linker: ng.ITranscludeFunction) {\r\n        this.revealers = [];\r\n        this.container = descriptor.Element.parent();\r\n        this.containerElement = this.container[0];\r\n        this.displayFrom = 0;\r\n        this.displayTo = 0;\r\n\r\n        // this way the memory can only leak until the scroller lives\r\n        this.descriptor.Scope.$on('$destroy', () => {\r\n            this.revealers = [];\r\n        });\r\n    }\r\n\r\n    public UpdateCollection = (newCollection: any[]) => {\r\n        if (this.collection == undefined) {\r\n            this.collection = newCollection;\r\n            this.InitializeRevealer();\r\n            this.AddBottom();\r\n        } else {\r\n            this.collection = newCollection;\r\n            this.updateScopes();\r\n        }\r\n    }\r\n\r\n    private updateScopes = () => {\r\n        let index = this.displayFrom;\r\n\r\n        for (let revealer of this.revealers) {\r\n            for (let i = 0; i < this.revealerSize; i++) {\r\n                const hasItemToBind = index < this.collection.length;\r\n                const hasElementToBind = revealer.Items.length > i;\r\n\r\n                if (hasItemToBind && hasElementToBind) {\r\n                    // nothing special, bind scope\r\n                    revealer.Items[i].Scope[this.descriptor.IndexString] = this.collection[index];\r\n                } else if (hasItemToBind) {\r\n                    // create element and bind\r\n                    const item = this.transcludeElement(index);\r\n                    revealer.Element.append(item.Element);\r\n                    revealer.Items.push(item);\r\n                } else if (hasElementToBind) {\r\n                    // remove element\r\n                    const item = revealer.Items.pop();\r\n                    item.Scope.$destroy();\r\n                    item.Element.remove();\r\n                } else {\r\n                    continue;\r\n                }\r\n\r\n                index++;\r\n            }\r\n\r\n            if (revealer.Items.length == 0) {\r\n                // remove revealer if it's not necessary anymore\r\n                revealer.Element.remove();\r\n            }\r\n        }\r\n\r\n        const currentDisplayTo = this.displayTo;\r\n        this.displayTo = index;\r\n\r\n        if (index < currentDisplayTo && this.collection.length > index) {\r\n            // create new revealers if necessary\r\n            this.AddBottom();\r\n        } else {\r\n            // remove unnecessary revealers\r\n            this.revealers = this.revealers.filter(r => r.Items.length > 0);\r\n        }\r\n    }\r\n\r\n    public InitializeRevealer = () => {\r\n        const newRevealer = this.createRevealer();\r\n        this.revealers.push(newRevealer);\r\n        this.container.append(newRevealer.Element);\r\n\r\n        let i = 0;\r\n        let isRevealerFilled = false;\r\n\r\n        while (!isRevealerFilled) {\r\n            const item = this.transcludeElement(i);\r\n            newRevealer.Element.append(item.Element);\r\n            newRevealer.Items.push(item);\r\n\r\n            const blockEl = item.Element[0];\r\n            const fillUntil = this.containerElement.offsetTop + this.containerElement.offsetHeight * this.REVEALER_SIZE_TO_CONTAINER;\r\n            const blockBottom = blockEl.offsetTop + blockEl.offsetHeight;\r\n\r\n            if (blockBottom > fillUntil) {\r\n                /* \r\n                    i had no better idea how to detect bottom line for the case of using floats,\r\n                    so when the first element passes the line, let's just correct it by removing that one\r\n                 */\r\n                const item = newRevealer.Items.pop();\r\n                item.Scope.$destroy();\r\n                item.Element.remove();\r\n\r\n                isRevealerFilled = true;\r\n                break;\r\n            }\r\n\r\n            i++;\r\n        }\r\n\r\n        this.revealerSize = i;\r\n        this.displayTo = i;\r\n    };\r\n\r\n    public AddTop = () => {\r\n        if (this.displayFrom == 0) {\r\n            return;\r\n        }\r\n\r\n        const newRevealer = this.createRevealer();\r\n        this.revealers.unshift(newRevealer);\r\n        this.container.prepend(newRevealer.Element);\r\n\r\n        let countTillStop = this.LOAD_COUNT;\r\n\r\n        for (var i = 0; i < this.revealerSize; i++) {\r\n            const index = this.displayFrom + 1 - i;\r\n            if (index < 0) {\r\n                break;\r\n            }\r\n\r\n            const newElement = this.transcludeElement(this.displayFrom - 1 - i);\r\n            newRevealer.Element.prepend(newElement.Element);\r\n            newRevealer.Items.unshift(newElement);\r\n        }\r\n\r\n        this.displayFrom -= i;\r\n    };\r\n\r\n    public AddBottom = () => {\r\n        if (this.displayTo == this.collection.length) {\r\n            return;\r\n        }\r\n\r\n        const newRevealer = this.createRevealer();\r\n        this.revealers.push(newRevealer);\r\n        this.container.append(newRevealer.Element);\r\n\r\n        for (var i = 0; i < this.revealerSize && this.displayTo + i < this.collection.length; i++) {\r\n            const item = this.transcludeElement(this.displayTo + i);\r\n            newRevealer.Element.append(item.Element);\r\n            newRevealer.Items.push(item);\r\n        }\r\n\r\n        this.displayTo += i;\r\n    };\r\n\r\n    public RemoveTop = () => {\r\n        if (this.revealers.length <= 3) {\r\n            return;\r\n        }\r\n\r\n        const revealer = this.revealers.shift();\r\n        this.displayFrom += revealer.Items.length;\r\n\r\n        while (revealer.Items.length > 0) {\r\n            const item = revealer.Items.pop();\r\n            item.Element.remove(); // TODO: might be unnecessary, since we remove the revealer too\r\n            item.Scope.$destroy();\r\n        }\r\n\r\n        revealer.Element.remove();\r\n    };\r\n\r\n    public RemoveBottom = () => {\r\n        if (this.revealers.length <= 3) {\r\n            return;\r\n        }\r\n\r\n        const revealer = this.revealers.pop();\r\n        this.displayTo -= revealer.Items.length;\r\n\r\n        while (revealer.Items.length > 0) {\r\n            const item = revealer.Items.pop();\r\n            item.Element.remove(); // TODO: might be unnecessary, since we remove the revealer too\r\n            item.Scope.$destroy();\r\n        }\r\n\r\n        revealer.Element.remove();\r\n        this.containerElement.scrollTo(0, this.containerElement.offsetHeight / 2);\r\n    };\r\n\r\n    private transcludeElement = (index: number): Item => {\r\n        const item = {} as Item;\r\n\r\n        const childScope = this.descriptor.Scope.$new();\r\n        childScope[this.descriptor.IndexString] = this.collection[index];\r\n\r\n        this.linker(childScope, (clone: JQLite) => {\r\n            item.Element = clone;\r\n            item.Scope = childScope;\r\n        });\r\n\r\n        return item;\r\n    }\r\n\r\n    private createRevealer = (): Revealer => {\r\n        const revealerElement = angular.element('<div class=\"revealer\"></div>');\r\n\r\n        const revealer: Revealer = {\r\n            Element: revealerElement,\r\n            Items: []\r\n        };\r\n\r\n        return revealer;\r\n    };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/revealer-elements-manager.ts"],"sourceRoot":""}